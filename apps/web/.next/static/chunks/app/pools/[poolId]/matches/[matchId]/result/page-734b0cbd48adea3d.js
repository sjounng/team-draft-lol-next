(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1819],{5222:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var l=a(413),s=a(3353),r=a(7950),n=a(8541),i=a.n(n);function c(e){let{team1Won:t,onSelectWinner:a}=e;return(0,l.jsxs)("div",{className:"card mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-[var(--text-primary)] mb-4",children:"승리 팀 선택"}),(0,l.jsxs)("div",{className:"flex gap-4",children:[(0,l.jsx)("button",{onClick:()=>a(!0),className:"flex-1 py-4 rounded-lg font-semibold transition-all ".concat(!0===t?"bg-[var(--accent-purple)] text-white":"bg-[var(--card-bg)] border-2 border-[var(--border-color)] text-[var(--text-primary)] hover:border-[var(--accent-purple)]"),children:"Team 1 승리"}),(0,l.jsx)("button",{onClick:()=>a(!1),className:"flex-1 py-4 rounded-lg font-semibold transition-all ".concat(!1===t?"bg-[var(--accent-blue)] text-white":"bg-[var(--card-bg)] border-2 border-[var(--border-color)] text-[var(--text-primary)] hover:border-[var(--accent-blue)]"),children:"Team 2 승리"})]})]})}function o(e){let{gameDuration:t,onChange:a}=e;return(0,l.jsxs)("div",{className:"card mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-[var(--text-primary)] mb-4",children:"게임 시간"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-[var(--text-muted)] mb-1",children:"게임 시간 (MM:SS)"}),(0,l.jsx)("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:"25:30",className:"input w-full md:w-1/3",pattern:"[0-9]{1,2}:[0-9]{2}"}),(0,l.jsx)("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"예: 25:30 (25분 30초)"})]})]})}function d(e){let{team1Kills:t,team2Kills:a,team1Gold:s,team2Gold:r,onTeam1KillsChange:n,onTeam2KillsChange:i,onTeam1GoldChange:c,onTeam2GoldChange:o}=e;return(0,l.jsxs)("div",{className:"card mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-[var(--text-primary)] mb-4",children:"팀 통계"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-[var(--accent-purple)] mb-3",children:"Team 1"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-[var(--text-muted)] mb-1",children:"총 킬수"}),(0,l.jsx)("input",{type:"number",min:"0",value:t,onChange:e=>n(e.target.value),placeholder:"0",className:"input w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-[var(--text-muted)] mb-1",children:"총 골드"}),(0,l.jsx)("input",{type:"number",min:"0",value:s,onChange:e=>c(e.target.value),placeholder:"0",className:"input w-full"})]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-[var(--accent-blue)] mb-3",children:"Team 2"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-[var(--text-muted)] mb-1",children:"총 킬수"}),(0,l.jsx)("input",{type:"number",min:"0",value:a,onChange:e=>i(e.target.value),placeholder:"0",className:"input w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm text-[var(--text-muted)] mb-1",children:"총 골드"}),(0,l.jsx)("input",{type:"number",min:"0",value:r,onChange:e=>o(e.target.value),placeholder:"0",className:"input w-full"})]})]})]})]})]})}let u={TOP:"탑",JGL:"정글",MID:"미드",ADC:"원딜",SUP:"서폿"},m={TOP:1,JGL:2,MID:3,ADC:4,SUP:5};function x(e){var t,a,s,r;let{player:n,stats:i,champion:c,accentColor:o,onUpdateStat:d}=e;return(0,l.jsxs)("div",{className:"bg-[var(--bg)] p-4 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,l.jsx)("span",{className:"text-xs font-semibold ".concat(o," w-12"),children:u[n.assignedPosition]}),(0,l.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,l.jsx)("span",{className:"text-sm font-semibold text-[var(--text-primary)]",children:n.name||n.username}),c&&(0,l.jsx)("span",{className:"text-xs ".concat(o),children:c})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs text-[var(--text-muted)] mb-1",children:"킬"}),(0,l.jsx)("input",{type:"number",min:"0",value:null!=(t=null==i?void 0:i.kills)?t:"",onChange:e=>d("kills",e.target.value),placeholder:"0",className:"input w-full text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs text-[var(--text-muted)] mb-1",children:"데스"}),(0,l.jsx)("input",{type:"number",min:"0",value:null!=(a=null==i?void 0:i.deaths)?a:"",onChange:e=>d("deaths",e.target.value),placeholder:"0",className:"input w-full text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs text-[var(--text-muted)] mb-1",children:"어시"}),(0,l.jsx)("input",{type:"number",min:"0",value:null!=(s=null==i?void 0:i.assists)?s:"",onChange:e=>d("assists",e.target.value),placeholder:"0",className:"input w-full text-sm"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-xs text-[var(--text-muted)] mb-1",children:"CS"}),(0,l.jsx)("input",{type:"number",min:"0",value:null!=(r=null==i?void 0:i.cs)?r:"",onChange:e=>d("cs",e.target.value),placeholder:"0",className:"input w-full text-sm"})]})]})]})}function h(e){let{teamNumber:t,teamName:a,accentColor:s,players:r,playerStats:n,match:i,onUpdatePlayerStat:c}=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold ".concat(s," mb-3"),children:a}),(0,l.jsx)("div",{className:"space-y-4",children:[...r].sort((e,t)=>(m[e.assignedPosition]||999)-(m[t.assignedPosition]||999)).map(e=>{let t=((e,t)=>{if(!(null==t?void 0:t.userRecords))return null;let a=t.userRecords.find(t=>t.userId===e);return(null==a?void 0:a.championName)||null})(e.userId,i),a=n[e.userId];return(0,l.jsx)(x,{player:e,stats:a,champion:t,accentColor:s,onUpdateStat:(t,a)=>c(e.userId,t,a)},e.userId)})})]})}function p(){let e=(0,r.useParams)(),t=(0,r.useRouter)(),a=e.poolId,n=e.matchId,[u,m]=(0,s.useState)(null),[x,p]=(0,s.useState)(!0),[v,b]=(0,s.useState)(!1),[j,f]=(0,s.useState)(null),[N,g]=(0,s.useState)(""),[y,S]=(0,s.useState)(""),[C,k]=(0,s.useState)(""),[I,w]=(0,s.useState)(""),[P,T]=(0,s.useState)(""),[D,E]=(0,s.useState)({});(0,s.useEffect)(()=>{G()},[]);let G=async()=>{try{let i=await fetch("/api/pools/".concat(a,"/matches/").concat(n));if(i.ok){let n=(await i.json()).data;if("DRAFT_COMPLETE"!==n.status&&"RESULT_PENDING"!==n.status){alert("밴픽이 완료된 전적만 결과를 입력할 수 있습니다."),t.push("/pools/".concat(a,"/matches"));return}if(m(n),"RESULT_PENDING"===n.status){var e,l,s,r;if(f(n.team1Won),g((null==(e=n.team1Kills)?void 0:e.toString())||""),S((null==(l=n.team2Kills)?void 0:l.toString())||""),k((null==(s=n.team1Gold)?void 0:s.toString())||""),w((null==(r=n.team2Gold)?void 0:r.toString())||""),n.gameDuration){let e=Math.floor(n.gameDuration/60),t=n.gameDuration%60;T("".concat(e,":").concat(t.toString().padStart(2,"0")))}}let c={};[...n.team1Data.players,...n.team2Data.players].forEach(e=>{var t,a,l,s,r;let i=null==(t=n.userRecords)?void 0:t.find(t=>t.userId===e.userId);c[e.userId]={userId:e.userId,kills:null!=(a=null==i?void 0:i.kills)?a:null,deaths:null!=(l=null==i?void 0:i.deaths)?l:null,assists:null!=(s=null==i?void 0:i.assists)?s:null,cs:null!=(r=null==i?void 0:i.cs)?r:null}}),E(c)}else alert("전적을 불러오는데 실패했습니다."),t.push("/pools/".concat(a,"/matches"))}catch(e){console.error("Error fetching match:",e),alert("전적을 불러오는 중 오류가 발생했습니다."),t.push("/pools/".concat(a,"/matches"))}finally{p(!1)}},R=(e,t,a)=>{if("userId"===t)return;let l=""===a?null:parseInt(a);E(a=>({...a,[e]:{...a[e],[t]:null!==l&&l<0?0:l}}))},O=async()=>{if(null===j)return void alert("승리 팀을 선택해주세요.");let e=parseInt(N)||0,l=parseInt(y)||0,s=parseInt(C)||0,r=parseInt(I)||0;if(0===e&&0===l)return void alert("팀 킬수를 입력해주세요.");if(0===s&&0===r)return void alert("팀 골드를 입력해주세요.");if(!P)return void alert("게임 시간을 입력해주세요.");let i=P.match(/^(\d{1,2}):(\d{2})$/);if(!i)return void alert("게임 시간을 MM:SS 형식으로 입력해주세요 (예: 25:30)");let c=parseInt(i[1]),o=parseInt(i[2]);if(o>=60)return void alert("초는 59 이하여야 합니다.");if(!Object.values(D).every(e=>null!==e.kills&&null!==e.deaths&&null!==e.assists&&null!==e.cs))return void alert("모든 플레이어의 통계를 입력해주세요.");let d=Object.values(D).map(e=>{var t,a,l,s;return{userId:e.userId,kills:null!=(t=e.kills)?t:0,deaths:null!=(a=e.deaths)?a:0,assists:null!=(l=e.assists)?l:0,cs:null!=(s=e.cs)?s:0}});b(!0);try{let i=await fetch("/api/pools/".concat(a,"/matches/").concat(n,"/result"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({team1Won:j,team1Kills:e,team2Kills:l,team1Gold:s,team2Gold:r,gameDuration:60*c+o,playerStats:d})});if(i.ok)alert("결과가 제출되었습니다. 관리자의 승인을 기다려주세요."),t.push("/pools/".concat(a,"/matches"));else{let e=await i.json();alert(e.error||"결과 제출에 실패했습니다.")}}catch(e){console.error("Error submitting result:",e),alert("결과 제출 중 오류가 발생했습니다.")}finally{b(!1)}};return x?(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--primary)]"})}):u?(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)(i(),{href:"/pools/".concat(a,"/matches"),className:"text-[var(--text-muted)] hover:text-[var(--text-primary)] mb-2 inline-block",children:"← 전적 목록으로 돌아가기"}),(0,l.jsx)("h1",{className:"text-3xl font-bold text-[var(--text-primary)]",children:"결과 입력"})]}),(0,l.jsx)(c,{team1Won:j,onSelectWinner:f}),(0,l.jsx)(o,{gameDuration:P,onChange:T}),(0,l.jsx)(d,{team1Kills:N,team2Kills:y,team1Gold:C,team2Gold:I,onTeam1KillsChange:g,onTeam2KillsChange:S,onTeam1GoldChange:k,onTeam2GoldChange:w}),(0,l.jsxs)("div",{className:"card mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-[var(--text-primary)] mb-4",children:"개별 플레이어 통계"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsx)(h,{teamNumber:1,teamName:"Team 1",accentColor:"text-[var(--accent-purple)]",players:u.team1Data.players,playerStats:D,match:u,onUpdatePlayerStat:R}),(0,l.jsx)(h,{teamNumber:2,teamName:"Team 2",accentColor:"text-[var(--accent-blue)]",players:u.team2Data.players,playerStats:D,match:u,onUpdatePlayerStat:R})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,l.jsx)(i(),{href:"/pools/".concat(a,"/matches"),className:"btn-secondary",children:"취소"}),(0,l.jsx)("button",{onClick:O,disabled:v,className:"btn-primary",children:v?"제출 중...":"결과 제출"})]})]}):null}},7950:(e,t,a)=>{"use strict";var l=a(3858);a.o(l,"useParams")&&a.d(t,{useParams:function(){return l.useParams}}),a.o(l,"usePathname")&&a.d(t,{usePathname:function(){return l.usePathname}}),a.o(l,"useRouter")&&a.d(t,{useRouter:function(){return l.useRouter}})},9139:(e,t,a)=>{Promise.resolve().then(a.bind(a,5222))}},e=>{e.O(0,[8541,2613,6299,7358],()=>e(e.s=9139)),_N_E=e.O()}]);