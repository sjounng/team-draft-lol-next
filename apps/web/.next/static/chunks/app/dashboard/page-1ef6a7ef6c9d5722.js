(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{21:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(413),r=s(5509),n=s(3353),l=s(7950),i=s(8541),c=s.n(i);function o(){var e;let{user:t,loading:s}=(0,r.A)(),i=(0,l.useRouter)(),[o,x]=(0,n.useState)([]),[m,h]=(0,n.useState)(!0),[u,v]=(0,n.useState)(!1),[j,p]=(0,n.useState)([]);(0,n.useEffect)(()=>{s||t||i.push("/login")},[t,s,i]),(0,n.useEffect)(()=>{t&&(f(),b())},[t]);let f=async()=>{try{let e=await fetch("/api/pools");if(e.ok){let t=await e.json();x(t.data)}}catch(e){console.error("Error fetching pools:",e)}finally{h(!1)}},b=async()=>{try{let e=await fetch("/api/users/me/champions?limit=3");if(e.ok){let t=await e.json();p(t.data)}}catch(e){console.error("Error fetching top champions:",e)}};return s||!t?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--accent-purple)]"})}):(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-black mb-3 gradient-text",children:"대시보드"}),(0,a.jsxs)("p",{className:"text-[var(--text-secondary)]",children:[t.username,"님, 환영합니다!"]})]}),(0,a.jsx)("div",{className:"card mb-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[var(--accent-purple)] to-[var(--accent-blue)] flex items-center justify-center text-white font-bold text-2xl",children:null==(e=t.username[0])?void 0:e.toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-[var(--text-primary)]",children:t.username}),t.riotId&&(0,a.jsxs)("p",{className:"text-sm text-[var(--text-secondary)]",children:["라이엇 ID: ",t.riotId,t.riotTag&&(0,a.jsxs)("span",{className:"text-[var(--accent-purple)]",children:["#",t.riotTag]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold gradient-text",children:t.score}),(0,a.jsx)("div",{className:"text-xs text-[var(--text-muted)] mt-1",children:"점수"})]}),(0,a.jsx)("div",{className:"h-12 w-px bg-[var(--border)]"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsxs)("div",{className:"text-3xl font-bold ".concat(t.winLossStreak>0?"text-[var(--success)]":t.winLossStreak<0?"text-[var(--error)]":"text-[var(--text-secondary)]"),children:[t.winLossStreak>0?"+":"",t.winLossStreak]}),(0,a.jsx)("div",{className:"text-xs text-[var(--text-muted)] mt-1",children:"연승/연패"})]}),(t.mainLane||t.subLane)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"h-12 w-px bg-[var(--border)]"}),(0,a.jsxs)("div",{className:"text-center mt-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t.mainLane&&(0,a.jsx)("div",{className:"text-sm font-semibold text-[var(--text-primary)]",children:t.mainLane}),t.mainLane&&t.subLane&&(0,a.jsx)("span",{className:"text-[var(--text-muted)]",children:"/"}),t.subLane&&(0,a.jsx)("div",{className:"text-sm font-semibold text-[var(--text-secondary)]",children:t.subLane})]}),(0,a.jsx)("div",{className:"text-xs text-[var(--text-muted)] mt-1",children:t.mainLane&&t.subLane?"주 / 부 라인":t.mainLane?"주 라인":"부 라인"})]})]})]})]})}),j.length>0&&(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-[var(--text-primary)] mb-4",children:"내가 많이 사용하는 챔피언"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:j.map((e,t)=>(0,a.jsxs)("div",{className:"card",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ".concat(0===t?"bg-gradient-to-br from-yellow-400 to-orange-500 text-white":1===t?"bg-gradient-to-br from-gray-300 to-gray-500 text-white":"bg-gradient-to-br from-orange-600 to-orange-800 text-white"),children:t+1}),(0,a.jsx)("div",{className:"w-16 h-16 rounded-lg overflow-hidden border-2 border-[var(--border)] flex-shrink-0",children:(0,a.jsx)("img",{src:"https://ddragon.leagueoflegends.com/cdn/15.1.1/img/champion/".concat(e.championId,".png"),alt:e.championName,className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none"}})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"font-bold text-[var(--text-primary)] truncate",children:e.championName}),(0,a.jsxs)("p",{className:"text-sm text-[var(--text-muted)]",children:[e.totalGames,"게임"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xs text-[var(--text-muted)] mb-1",children:"승률"}),(0,a.jsxs)("div",{className:"text-lg font-bold ".concat(e.winRate>=.55?"text-green-400":e.winRate>=.45?"text-yellow-400":"text-red-400"),children:[(100*e.winRate).toFixed(0),"%"]})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xs text-[var(--text-muted)] mb-1",children:"KDA"}),(0,a.jsx)("div",{className:"text-lg font-bold text-[var(--text-primary)]",children:e.kda.toFixed(2)})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-xs text-[var(--text-muted)] mb-1",children:"CS/분"}),(0,a.jsx)("div",{className:"text-lg font-bold text-[var(--text-primary)]",children:e.csPerMin.toFixed(1)})]})]}),(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-[var(--border)]",children:(0,a.jsxs)("div",{className:"text-xs text-[var(--text-muted)] space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"평균 K/D/A"}),(0,a.jsxs)("span",{className:"text-[var(--text-secondary)]",children:[e.avgKills.toFixed(1)," /"," ",e.avgDeaths.toFixed(1)," /"," ",e.avgAssists.toFixed(1)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"전적"}),(0,a.jsxs)("span",{className:"text-[var(--text-secondary)]",children:[e.wins,"승 ",e.losses,"패"]})]})]})})]},e.championId))})]}),(0,a.jsxs)("div",{className:"flex gap-4 mb-8",children:[(0,a.jsxs)(c(),{href:"/pools/create",className:"btn-primary",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2 inline-block",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"새 Pool 만들기"]}),(0,a.jsxs)("button",{onClick:()=>v(!0),className:"btn-secondary",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2 inline-block",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Pool 검색 & 가입"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-[var(--text-primary)]",children:"내 Pools"}),!m&&(0,a.jsxs)("span",{className:"text-sm text-[var(--text-muted)]",children:["총 ",o.length,"개"]})]}),m?(0,a.jsx)("div",{className:"card",children:(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--accent-purple)]"})})}):0===o.length?(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4 text-[var(--text-muted)]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-[var(--text-primary)] mb-2",children:"아직 Pool이 없습니다"}),(0,a.jsx)("p",{className:"text-sm text-[var(--text-secondary)] mb-6",children:"새로운 Pool을 만들거나 기존 Pool에 가입하세요"}),(0,a.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,a.jsx)(c(),{href:"/pools/create",className:"btn-primary",children:"Pool 만들기"}),(0,a.jsx)("button",{onClick:()=>v(!0),className:"btn-secondary",children:"Pool 검색"})]})]})}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(e=>(0,a.jsx)(c(),{href:"/pools/".concat(e.poolId),children:(0,a.jsxs)("div",{className:"card-hover h-full",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-[var(--text-primary)]",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:["#",e.tag]})]}),e.isOwner&&(0,a.jsx)("span",{className:"badge px-2 py-1 text-xs font-semibold rounded-full bg-gradient-to-r from-[var(--accent-purple)] to-[var(--accent-blue)] text-white",children:"Owner"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center text-[var(--text-secondary)]",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.memberCount,"명"]}),e.isOwner&&e.pendingRequestCount>0&&(0,a.jsxs)("div",{className:"flex items-center text-[var(--accent-purple)]",children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"가입 요청 ",e.pendingRequestCount,"개"]})]})]})},e.poolId))})]}),u&&(0,a.jsx)(d,{onClose:()=>v(!1),onSuccess:f})]})}function d(e){let{onClose:t,onSuccess:s}=e,[r,l]=(0,n.useState)(""),[i,c]=(0,n.useState)([]),[o,d]=(0,n.useState)(!1),[x,m]=(0,n.useState)(""),[h,u]=(0,n.useState)(""),v=async()=>{if(r.trim()){d(!0),m("");try{let e=await fetch("/api/pools/search?q=".concat(encodeURIComponent(r)));if(e.ok){let t=await e.json();c(t.data)}else m("검색에 실패했습니다.")}catch(e){m("검색 중 오류가 발생했습니다.")}finally{d(!1)}}},j=async(e,t)=>{try{let s=await fetch("/api/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({poolId:e,receiverId:t,type:"REQUEST"})});if(s.ok)u("가입 요청을 보냈습니다! Pool 소유자가 수락하면 참여할 수 있습니다."),c(t=>t.filter(t=>t.poolId!==e)),m("");else{let e=await s.json();m(e.error||"요청 전송에 실패했습니다."),u("")}}catch(e){m("요청 전송 중 오류가 발생했습니다."),u("")}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:t,children:(0,a.jsxs)("div",{className:"card max-w-2xl w-full",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold gradient-text",children:"Pool 검색 & 가입"}),(0,a.jsx)("button",{onClick:t,className:"text-[var(--text-muted)] hover:text-[var(--text-primary)]",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x&&(0,a.jsx)("div",{className:"mb-4 px-4 py-3 rounded-lg bg-[var(--error)]/10 border border-[var(--error)]/30 text-[var(--error)] text-sm",children:x}),h&&(0,a.jsx)("div",{className:"mb-4 px-4 py-3 rounded-lg bg-[var(--success)]/10 border border-[var(--success)]/30 text-[var(--success)] text-sm",children:h}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:r,onChange:e=>l(e.target.value),onKeyDown:e=>"Enter"===e.key&&v(),placeholder:"Pool 이름 또는 #태그로 검색...",className:"input flex-1"}),(0,a.jsx)("button",{onClick:v,disabled:o,className:"btn-primary",children:o?(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):"검색"})]}),(0,a.jsx)("p",{className:"text-xs text-[var(--text-muted)] mt-2",children:'예시: "MyPool", "#A1B2" 또는 "MyPool#A1B2"'})]}),(0,a.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:0===i.length?(0,a.jsx)("div",{className:"text-center py-8 text-[var(--text-muted)]",children:"검색 결과가 없습니다"}):i.map(e=>(0,a.jsxs)("div",{className:"card-hover flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-[var(--text-primary)]",children:e.name}),(0,a.jsxs)("span",{className:"text-xs text-[var(--text-muted)]",children:["#",e.tag]})]}),(0,a.jsxs)("p",{className:"text-sm text-[var(--text-secondary)]",children:[e.memberCount,"명 \xb7 ",e.ownerUsername]})]}),(0,a.jsx)("button",{onClick:()=>j(e.poolId,e.ownerId),className:"btn-primary",children:"요청 보내기"})]},e.poolId))})]})})}},5509:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>i});var a=s(413),r=s(3353),n=s(7950);let l=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,r.useState)(null),[c,o]=(0,r.useState)(!0),d=(0,n.useRouter)();(0,r.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let t=await e.json();i(t.data)}else i(null)}catch(e){console.error("Error fetching user:",e),i(null)}finally{o(!1)}},m=async(e,t)=>{let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!s.ok)throw Error((await s.json()).error||"Login failed");i((await s.json()).data.user),d.push("/dashboard")},h=async e=>{let t=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Registration failed");i((await t.json()).data.user),d.push("/dashboard")},u=async()=>{await fetch("/api/auth/logout",{method:"POST"}),i(null),d.push("/login")},v=async()=>{await x()};return(0,a.jsx)(l.Provider,{value:{user:s,loading:c,login:m,register:h,logout:u,refreshUser:v},children:t})}function c(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},7683:(e,t,s)=>{Promise.resolve().then(s.bind(s,21))},7950:(e,t,s)=>{"use strict";var a=s(3858);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})}},e=>{e.O(0,[8541,2613,6299,7358],()=>e(e.s=7683)),_N_E=e.O()}]);